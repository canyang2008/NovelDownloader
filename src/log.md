# NovelDownloader 更新日志

## 说明

***因热爱而坚持，因热爱而努力。***  
***谨记记录每一刻的自己***

## 更新记录
- ### 2025/10/18

  **版本：NovelDownloader-1.1.Lastest**
  
  **修改**
  - 图片保存在错误目录或者不保存
  - 因过早切割关键小说链接参数而造成分享页链接提取不到关键参数而报错

  **说明**
  这是1.1.x的最后一个版本了，下版本将跳转到1.2.0  
  下版本预告：
    - 多线程下载，快速下载同一种小说
    - 批量同时下载多种不同的小说
    - `UrlConfig.json`和`SettingConfig.json`配置文件添加，不与现有配置文件冲突
    - 保存时不占用大量内存和硬盘资源
    - 衍生工具：番茄图片下载器
  
  ⚠️注意：下版本重构代码结构  


- ### 2025/10/12
  
  **版本：NovelDownloader-1.1.7**

  **修改**
  - 使用多线程保存JSON，减少等待时间
  - 重新启用保存配置中HTML的`one_file`(图片嵌入HTML)设置
  - 优化以减少一些无用的内存使用量

- ### 2025/10/07

  **版本：NovelDownloader-1.1.6**

  **修改**
  - 不通过Github获取`UserConfig.json`模板
  - 重置错误的bug

- ### 2025/10/06

  **版本：NovelDownloader-1.1.5**

  **说明**
  - `UserConfig.json`字段`Unprocess`类型还是不改了
  - 备份功能原本是好的，但是好像上传错版本了，导致无法正常使用  
  
  **添加**

  - 比较完整的设置功能
  - 可以通过外部调用程序直接下载(内部暂不支持)  
    支持的参数：
    - `--url`: str
    - `--update`: bool = True
    - `--range`: str | None = None

- ### 2025/10/05
  
  **版本：NovelDownloader-1.1.4**
  
  **说明**
  
  - NovelDownloader-1.3.0将会融合添加(回归)`SettingConfig.json`和`UrlConfig.json`配置文件，可以将所有配置统一集中在此  
  - 如果下载小说时卡在提示Key不能为空时，可以通过 设置 -> 获取模式 ->切换为 Chrome模式
  
  **修改**
  
  - 起点 支持下载VIP可直接获取章节
  - 完善备份功能(临时)
  - 配置文件：
    - `UserConfig.json`：  
      - 字段`Unprocess`类型将在下版本转换成字典以添加更多的备份功能  
      - 字段`Save_method`添加`enable`，是否以某格式保存  

  **添加**
  
  - 默认参数修改功能（当前：获取模式切换、Chrome设置）
  - 支持中断重新下载功能
  - 账户操作更新回归，分组操作回归
  - `UserConfig.json`的`Save_method`各个文件格式下面添加`enable`字段用以判断是否以该格式保存

- ### 2025/10/04

  **版本：NovelDownloader-1.1.3**

  **说明**

  原本NovelDownloader-1.1.2的`requests`请求的参数会通过创建用户的新`UserConfig.json`内没有添加在内

  **添加**

  - 完整的备份功能
  - 添加README.md

  **修改**

  - 番茄 因未登录而报错
  - 功能 备份功能
  - **删除用户/分组操作**

- ### 2025/10/03

  **版本：NovelDownloader-1.1.2**

  **添加**

  - 起点 作者描述
  - 起点 一些目录页面信息处理，参考：book id=1011945842
  - 起点 支持分享链接
  - 功能 支持备份功能

  **修改**

  - 起点 获取章节字数时报错。

- ### 2025/10/02

  **版本：NovelDownloader-1.1.1**

  **添加**

  - `log.md`
  - **添加下载 *Biqugegu* 的支持**
  - 笔趣阁登录
  - 部分添加了一些注释
  - 添加`UserConfig.json`的requests和线程数参数，包含通过登陆获取的Cookie

  **修改**

  - 不再支持携带参数下载
  - 保存逻辑完全更改
  - 修改html无法保存/显示的问题

- ### 2025/9/21(重构)

  **版本：NovelDownloader-1.1.0**

  **修改**

  - 不再由`SettingConfig.json`和`UrlConfig.json`统领所有配置
  - 通过`manage.json`、`UserConfig.json`和`mems.json`统一管理所有配置

- ### 2025/9/06 -P2

  **版本：NovelDownloader-1.0.5**

  **修改**

  - 批量下载下一个时报错的小bug
  - 当标题存在特殊符号时无法保存以标题为名的文件bug

- ### 2025/9/06 -P1

  #### 版本：NovelDownloader-1.0.4

  #### 修改

  - 无法更新导致崩溃的bug
  - 分组切换的bug和细节
  - 下载番茄小说因时间久远而无法下载插图的瑕疵

- ### 2025/9/05

  **版本：NovelDownloader-1.0.3**

  **添加**

  - 程序报错日志，便于 检查/反馈 问题
  - 用户状态（是否登录，是否有vip）检查并提示

  **修改**

  - 重大修复！！！：输入链接（参数）因链接携带参数（“?”及其“=”）造成崩溃的bug。以及检查配置都会初始化的bug
  - 每次更新不会同时更新小说信息的bug
  - 处理带特殊字符的参数更加精确
  - 小说章节更新时间更加准确

- ### 2025/8/31

  **版本：NovelDownloader-1.0.2**

  **修复**

  - 一些大bug，起点下载的bug

- ### 2025/8/30

  **版本：NovelDownloader-1.0.1**

  **添加**

  - 默认值修改功能（除保存方式以外）
  - 一些项目信息
  - 启动前配置更新检查
  - 同时将json保存到根数据目录
  - 首次运行时初始化操作

  **修改**

  - 一些bug
  - 更新时保存逻辑

- ### 2025/8/23(公开至Github)

  **版本：NovelDownloader-1.0.0**

  **添加**

  - 是否在下载完一个小说时添加提示音的功能

  **修改**

  - 移除日志功能
  - 修复分组内操作的bug

---

- ### 2025/8/22

  **版本：NovelDownloader 2.0**

  **添加**

  - 支持按范围更新
  - 支持分组操作，与“账户操作”同理

  **修改**

  - 分散库，不再通过moudule.py统一集中调用
  - 将“账户操作”功能调至设置功能
  - 强制控制台输出UTF-8编码（已移除）

- ### 2025/8/21

  **版本：NovelDownloader 2.0**

  **添加**

  - 支持灵活修改保存路径，使保存的路径更加准确

  **修改**

  - 支持更新功能
  - 进行文件读取操作时使用utf-8，移除BOM
  - 移除不必要的库

- ### 2025/8/20

  **版本：NovelDownloader 2.0**

  **添加**

  - 支持携带参数的下载
  - 添加功能：账户、更新小说，下载，批量下载，指定章节下载，设置
  - 小说保存方式支持html格式保存，支持图片是否嵌入html的功能

  **修改**

  - 使用DrissionPage库替代session库，移除Chromedriver.exe，仅能使用Chrome获取html
  - 更加智能的获取html
  - 修复浏览器被关闭时无法自动重启
  - 小说标题合法化

- ### 2025/8/04(重构)

  **版本：NovelDownloader 2.0**

  **添加**

  - 支持txt按文件大小分割文件功能（追加）

  **修改**

  - 日志信息更加合理
  - GetHtml.py的重新启动严重错误
  - Save.py的txt保存分割（按文件大小，分块）文件有独立目录
  - txt按文件大小分割文件功能（重写）功能逻辑

---

- ### 2025/07/23(重构)(版本介绍)

  **版本：NovelDownloader**
  
  **添加**

  - 图片下载支持
  - 番茄小说分享链接支持
  - 支持下载小说封面图片和章节内嵌图片
  - 配置系统重构
  - UrlConfig.json：分组管理 URL（默认组为 "Default"）
  - 智能驱动匹配
    - 自动检测系统浏览器版本
    - 匹配浏览器与驱动版本：
      - 架构型号不一致 → 提示用户下载匹配驱动
      - 主版本号不一致 → 自动下载适配驱动
  - 小说下载工具功能列表
    - 下载功能  

      | 功能         | 描述       | 参数格式                             |
      |------------|----------|----------------------------------|
      | **更新小说**   | 更新已存储的小说 | 支持章节范围组合（如 `1-3,5,7-9`）          |
      | **单本下载**   | 下载单本小说   | `URL [组名]`（组名可选）                 |
      | **批量下载**   | 批量下载多本小说 | 读取 `urls.txt` （每行格式：`URL [组名]`）  |
      | **指定章节下载** | 下载特定章节范围 | 先输入 `URL`，再指定章节范围（如 `1-3,5,7-9`） |

    - 系统功能

      | 功能       | 描述                            |
      |----------|-------------------------------|
      | **驱动匹配** | 自动处理浏览器与驱动兼容性问题               |
      | **配置管理** | 自动应用层级化配置：`URL专属 > 分组 > 全局默认` |

  - 每个 URL 可独立配置：
    - 浏览器类型
    - 浏览器用户数据目录
    - 浏览器驱动路径
    - 小说保存方法
    - 网页等待时间
    - 图片保存路径
    - 更新状态跟踪
    - 时间戳记录（首次下载/最后操作时间）

  - `SettingConfig.json`：全局默认配置：
    - 程序绝对路径
    - 下载失败URL记录
    - 默认浏览器设置
    - 驱动路径
    - 等待时间
    - 小说保存方法
    - 智能驱动匹配
    - 自动检测系统浏览器版本
    - 匹配浏览器与驱动版本：
    - 架构型号不一致 → 提示用户下载匹配驱动
    - 主版本号不一致 → 自动下载适配驱动

- ### 2025/7/28

  **版本：NovelDownloader**

  **修改**

  - 保存图片的逻辑，在`UrlConfig.json`的`img_dir`的指定路径更加精确
  - 修复txt的保存逻辑错误，不再创建新文件夹仅保存文件

- ### 2025/7/21

  **版本：NovelDownloader**

  **修改**

  - 保存配置的逻辑，不易被中断而损坏
  - `save_method`的逻辑，将`Img_dir`移至`json`中
  - `save_method`保存文件的逻辑
  - 保存图片的逻辑，不一直重复保存同一图片：同名图片时不被覆盖
  - 下载下一小说时重置配置

- ### 2025/7/20

  **版本：NovelDownloader**

  **添加**

  - 实现未处理参数的功能，即继续下载的功能

  **修改**

  - `Range_to_list` 函数的逻辑，返回格式化的范围，名首字母改为小写。

- ### 2025/7/19

  **版本：NovelDownloader**

  **添加**

  - 在 `NovelDownloader.py` 中添加 `save_config` 方法，确保配置保存过程不被中断。
  - 支持按文件大小保存txt文件，标注保存逻辑
  - 新的 ChromeDriver 和其可执行文件 `chromedriver.exe`。

  **修改**

  - 不合理的小说存储图片的路径逻辑
  - `SettingConfig.json` 和 `UrlConfig.json` 中的用户数据目录和驱动路径。
  - 更新 `SettingConfig.json` 和 `UrlConfig.json` 中的用户数据目录和驱动路径。
  - txt存储的文件夹名称，标注分块逻辑
  - 小说图片的名字，标注图片来源的标题
  - 获取需更新小说下载链接的逻辑，未下载的和不完整的
  - 小说信息获取

---

- ### 2025/07/09(重构)(版本介绍)

  **版本：API-GetNovelCollection**

  **核心思路**

  - 支持番茄/起点小说
  - 可配置 Selenium 参数：
    - 浏览器类型（Chrome/Edge）
    - 用户数据目录
    - 驱动路径
  - 支持分块保存 TXT（每 N 章一个文件）
  - 进度条显示（tqdm）
  - 数据结构规范

  **功能**

  - **获取章节名称/URL**
      输入目录页 URL，返回章节列表（支持筛选范围如 1-3,5,7-9）
  - **按章节 URL 下载**
      直接下载指定章节
  - **全本下载**
      可选更新模式（需 JSON 路径）或章节范围

---

- ### 2025/05/??(重构)(版本介绍)

  **版本：v3.0**

  **核心思路**

  - 转向盗版网站下载
  - 采用面向对象设计
  - 解析库组合：BeautifulSoup + requests + selenium
  
  **功能**

  - **官网 URL 下载**  
    输入番茄/起点 URL，自动搜索盗版网站并抓取
  - **盗版直链下载**  
    直接输入盗版网站 URL 下载
  *吃力不讨好的项目*

- ### 2025/05/0?(重构)(版本介绍)

  **版本：v2.0**

  **核心思路**

  - 用正则严格校验 URL
  - 通过 构建的`HTML` 类管理小说信息
  - 源码无目标内容时重试 3 次，失败则触发 Windows 通知+提示音
  - 模块化翻译/存储功能，优先级设为最高

  **功能**

  - **更新小说**：支持指定单本更新
  - **批量/单本下载**：同前
  - **指定章节下载**  
    文件名包含章节范围（如 `1-5 小说名.txt`）
  - **格式转换**  
    支持 JSON→TXT（弹窗选文件）、TXT→ODT

---

- ### 2025/04/06(重构)(版本介绍)

  **版本：v1.1**

  **核心思路**

  - 拆分为两个脚本：
    - `get_source.py`：用 Selenium 获取源码（支持页面加载等待）
    - `main.py`：添加请求重试机制

  **功能**

  - **更新/单本下载**：同 v1.0
  - **批量下载**  
    读取 `urls.txt`（每行一个 URL），逐个执行单本下载
  - **指定章节下载**  
    输入 `URL 起始章 终章`（空格分隔），无视 `url.json` 直接下载

---

- ### 2025/0?/??(初始)(版本介绍)

  **核心思路**

  - 通过 `requests` 库发送带 `User-Agent`、`Referer`、`Cookie` 的请求
  - 获取小说目录页（`page` URL）HTML 源码
  - 提取所有章节阅读页（`reader` URL）
  - 遍历章节 URL 获取内容，用预置字典翻译乱码文本
  
  **功能**

  - **更新小说**  
    读取 `url.json`（存储 `{小说名: 小说信息/目录页URL}`），更新所有小说
  - **单本下载**  
    输入目录页 URL，下载小说并保存为 JSON/TXT 文件
  - **获取 Cookie**  
    通过 `cookies.py` 调用 Selenium 的 EdgeDriver 获取

## 初衷

使用番茄下载工具被 番茄 IP封禁了，忍无可忍自己做一个（憋屈）
